"use strict";function _objectWithoutProperties(t,r){if(null==t)return{};var e,n,o=_objectWithoutPropertiesLoose(t,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)e=i[n],r.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(t,e)&&(o[e]=t[e])}return o}function _objectWithoutPropertiesLoose(t,r){if(null==t)return{};var e,n,o={},i=Object.keys(t);for(n=0;n<i.length;n++)e=i[n],r.indexOf(e)>=0||(o[e]=t[e]);return o}function _templateObject(){var t=_taggedTemplateLiteral(["<h1 style='text-align: center;'>404</h1>"]);return _templateObject=function(){return t},t}function _taggedTemplateLiteral(t,r){return r||(r=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(r)}}))}function _toArray(t){return _arrayWithHoles(t)||_iterableToArray(t)||_nonIterableRest()}function _slicedToArray(t,r){return _arrayWithHoles(t)||_iterableToArrayLimit(t,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(t,r){var e=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(e.push(a.value),!r||e.length!==r);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return e}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _objectSpread(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{},n=Object.keys(e);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(e).filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.forEach(function(r){_defineProperty(t,r,e[r])})}return t}function _defineProperty(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var r=0,e=new Array(t.length);r<t.length;r++)e[r]=t[r];return e}}var nano_spa=function(){var t=function(t){for(var r,e,n=1,o="",i="",a=[0],u=function(t){1===n&&(t||(o=o.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?a.push(t||o,0):3===n&&(t||o)?(a.push(t||o,1),n=2):2===n&&"..."===o&&t?a.push(t,3):2===n&&o&&!t?a.push(!0,2,o):4===n&&e&&(a.push(t||o,2,e),e=""),o=""},c=0;c<t.length;c++){c&&(1===n&&u(),u(c));for(var l=0;l<t[c].length;l++)r=t[c][l],1===n?"<"===r?(u(),a=[a],n=3):o+=r:i?r===i?i="":o+=r:'"'===r||"'"===r?i=r:">"===r?(u(),n=1):n&&("="===r?(n=4,e=o,o=""):"/"===r?(u(),3===n&&(a=a[0]),n=a,(a=a[0]).push(n,4),n=0):" "===r||"\t"===r||"\n"===r||"\r"===r?(u(),n=2):o+=r)}return u(),a},r="function"==typeof Map,e=r?new Map:{},n=r?function(r){var n=e.get(r);return n||e.set(r,n=t(r)),n}:function(r){for(var n="",o=0;o<r.length;o++)n+=r[o].length+"-"+r[o];return e[n]||(e[n]=t(r))},o=function(t){var r=function t(r,e,n,o){for(var i=1;i<e.length;i++){var a=e[i++],u="number"==typeof a?n[a]:a;1===e[i]?o[0]=u:2===e[i]?(o[1]=o[1]||{})[e[++i]]=u:3===e[i]?o[1]=Object.assign(o[1]||{},u):o.push(e[i]?r.apply(null,t(r,u,n,["",null])):u)}return o}(this,n(t),arguments,[]);return r.length>1?r:r[0]}.bind(function t(r,e){for(var n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];var a={type:r,props:e,children:o};return a.props=a.props||{},a.props.style&&(a.props.style=a.props.style.trim().split("\n").map(function(t){return t.trim()}).join("")),"function"==typeof r?function(r){if("AsyncFunction"===r.type.constructor.name)return t("__PROMISE__",{promise:r},[]);var e=r.type(r.props),n="function"==typeof e?e():e;return t.apply(void 0,[n.type,n.props].concat(_toConsumableArray(n.children.concat(r.children))))}(a):a}),i={root:void 0,routes:{},head:{},methods:{},cache:[]};function a(t){var r=t.type,e=t.props,n=t.children,o=function(t,r){var e=this;t.forEach(function(t){void 0!=t&&("string"==typeof t||"number"==typeof t?r.appendChild(document.createTextNode(t)):Array.isArray(t)?t.map(function(t){return r.appendChild(a.call(e,_objectSpread({},t)))}):r.appendChild(a.call(e,_objectSpread({},t))))})}.bind(this);if("Link"===r)return this.LINK(t);if("__PROMISE__"===r)return this.PROMISE(t);var i=document.createElement(r);return function(t,r){Object.entries(t).forEach(function(t){var e=_slicedToArray(t,2),n=e[0],o=e[1];n.startsWith("on")&&window.hasOwnProperty(n)?r[n]=o:r.setAttribute(n,o)})}(e,i),o(n,i),i}var u,c=function(){return window.location.pathname},l=function(t){return window.history.pushState({},"",t)},p=function(t){return i.methods.on_route_unmount&&i.methods.on_route_unmount(t||c(),i.root.children[0])},f=function(t,r){var e=void 0;return r[t]?e:(Object.keys(r).filter(function(e){return"*"!==e||r.hasOwnProperty(t)}).map(function(n){var o=new RegExp(n);if(o.test(t)){var i=o.exec(t);if(o.test(t)&&i.length>=2){var a=_toArray(i).slice(1);e=r[n]?[r[n],a]:void 0}}}),e)},s=document.head,h=[],y=function(t){return t.map(function(t){var r=a(t);return s.appendChild(r),r})},d=function(t){return Array.isArray(t)?t:[t]},b=function(t,r){return r?h=y(d(t)):y(d(t))},_=function(t,r){return i.routes[t]?i.routes[t]():r?r[0](r[1]):(i.routes["*"]?i.routes["*"]:function(){return o(_templateObject())})()},m=function(t,r){(function(t){i.methods.on_route_mount&&i.methods.on_route_mount(c(),t)})(r),function(t){h.map(function(t){return s.removeChild(t)});var r=f(t,i.head);r?b(r[0](r[1]),!0):i.head[t]?b(i.head[t](),!0):h=[]}(t),u=r,i.root.innerHTML="",i.root.appendChild(u)},v={},g={PROMISE:function(t){var r=a.bind(this),e=t.props,n=e.promise.props,o=n.placeholder,i=_objectWithoutProperties(n,["placeholder"]),u=e.promise.type(i),c=o(),l=r(c);return u.then(function(t){l.replaceWith(r(t))}),l},LINK:function(t){var r=a.bind(this),e=t.children[0],n=r(e),o=t.props.href;"href"in n&&(n.href=o);var u=f(o,i.routes);return n.onclick=function(t){if(t.preventDefault(),c()!=o){p(),l(o);var e=r(_(o,u));m(o,e)}},n}},O=function(){var t=a.bind(g),r=c(),e=i.cache.includes(r),n=f(r,i.routes),o=t(_(r,n));v[r]||(v[r]=o),m(r,e?o:v[r])};return{render:o,router:function(t){Object.assign(i,t),function(t){document.querySelectorAll(".LINK").forEach(function(r){r.onclick=function(r){r.preventDefault();var e=this.getAttribute("href");c()!==e&&(p(),l(e),t())}})}(O),b(i.head["*"]&&i.head["*"](),!1),O();var r=c();window.onpopstate=function(){p(r),r=c(),O()}},to_dom:a.bind(g)}}();module.exports=nano_spa;
