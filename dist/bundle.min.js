var nano_spa=function(){"use strict";var t=function(n,e,r,o){for(var i=1;i<e.length;i++){var s=e[i++],p="number"==typeof s?r[s]:s;1===e[i]?o[0]=p:2===e[i]?(o[1]=o[1]||{})[e[++i]]=p:3===e[i]?o[1]=Object.assign(o[1]||{},p):o.push(e[i]?n.apply(null,t(n,p,r,["",null])):p)}return o},n=function(t){for(var n,e,r=1,o="",i="",s=[0],p=function(t){1===r&&(t||(o=o.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?s.push(t||o,0):3===r&&(t||o)?(s.push(t||o,1),r=2):2===r&&"..."===o&&t?s.push(t,3):2===r&&o&&!t?s.push(!0,2,o):4===r&&e&&(s.push(t||o,2,e),e=""),o=""},c=0;c<t.length;c++){c&&(1===r&&p(),p(c));for(var u=0;u<t[c].length;u++)n=t[c][u],1===r?"<"===n?(p(),s=[s],r=3):o+=n:i?n===i?i="":o+=n:'"'===n||"'"===n?i=n:">"===n?(p(),r=1):r&&("="===n?(r=4,e=o,o=""):"/"===n?(p(),3===r&&(s=s[0]),r=s,(s=s[0]).push(r,4),r=0):" "===n||"\t"===n||"\n"===n||"\r"===n?(p(),r=2):o+=n)}return p(),s},e="function"==typeof Map,r=e?new Map:{},o=e?function(t){var e=r.get(t);return e||r.set(t,e=n(t)),e}:function(t){for(var e="",o=0;o<t.length;o++)e+=t[o].length+"-"+t[o];return r[e]||(r[e]=n(t))};var i=function(n){var e=t(this,o(n),arguments,[]);return e.length>1?e:e[0]}.bind(function t(n,e,...r){const o={type:n,props:e,children:r};return o.props=o.props||{},o.props.style&&(o.props.style=(t=>t.trim().split("\n").map(t=>t.trim()).join(""))(o.props.style)),"function"==typeof n?function(n){if("AsyncFunction"===n.type.constructor.name)return t("__PROMISE__",{promise:n},[]);const e=n.type(n.props),r="function"==typeof e?e():e;return t(r.type,r.props,...r.children.concat(n.children))}(o):o});function s(t){let{type:n,props:e,children:r}=t;const o=function(t,n){t.forEach(t=>{void 0!=t&&("string"==typeof t||"number"==typeof t?n.appendChild(document.createTextNode(t)):Array.isArray(t)?t.map(t=>n.appendChild(s.call(this,{...t}))):n.appendChild(s.call(this,{...t})))})}.bind(this);if("Link"===n)return this.LINK(t);if("__PROMISE__"===n)return this.PROMISE(t);const i=document.createElement(n);return function(t,n){Object.entries(t).forEach(([t,e])=>{t.startsWith("on")&&t.toLowerCase()===t?n[t]=e:n.setAttribute(t,e)})}(e,i),o(r,i),i}const p=()=>window.location.pathname,c=t=>window.history.pushState({},"",t),u=(t,n,e)=>t.on_route_unmount&&t.on_route_unmount(e||p(),n.root.children[0]),a=(t,n)=>{let e=void 0;return Object.keys(n).filter(t=>"*"!==t).map(r=>{if(n[t])return;const o=new RegExp(r),i=o.exec(t);if(o.test(t)&&i.length>=2){const[,...t]=i;e=n[r]?[n[r],t]:void 0}}),e},l=t=>({replace_with(n){t.innerHTML="",t.appendChild(n)},root:t}),h=(t={})=>{const n=document.head;let e=[];const r=t=>{const e=s(t);return n.appendChild(e),e},o=t=>t.map(r),i=(t,n)=>t?Array.isArray(t)?n?e=o(t):o(t):n?e=[r(t)]:r(t):void 0;return i(t["*"]&&t["*"](),!1),{set(r){(()=>e.map(t=>n.removeChild(t)))();const o=a(r,t);return o?i(o[0](o[1]),!0):t[r]?void i(t[r](),!0):e=[]}}},d=(t,n,e,r,o)=>{const l={},h=t["*"]?t["*"]:()=>i`<h1 style='text-align: center;'>404</h1>`,d=(n,e)=>t[n]?t[n]():e?e[0](e[1]):h(),f=(t,o)=>{((t,n)=>t.on_route_mount&&t.on_route_mount(p(),n))(r,o),e.set(t),n.replace_with(o)},m={PROMISE:t=>{const n=s.bind(m),{props:e}=t,{placeholder:r,...o}=e.promise.props,i=e.promise.type(o),p=r(),c=n(p);return i.then(t=>{c.parentNode.replaceChild(n(t),c)}),c},LINK:e=>{const o=s.bind(m),i=e.children[0],p=o(i),l=e.props.href;p.href=l;const h=a(l,t);return p.onclick=(t=>{t.preventDefault(),u(r,n),c(l);const e=o(d(l,h));f(l,e)}),p}};return{render:()=>{const n=s.bind(m),e=p(),r=o.includes(e),i=a(e,t),c=n(d(e,i));l[e]||(l[e]=c),f(e,r?c:l[e])}}},f=(t,n,e)=>{document.querySelectorAll(".LINK").forEach(r=>{r.onclick=function(r){r.preventDefault();const o=this.getAttribute("href");p()!==o&&(u(e,n),c(o),t(o))}})};return{render:i,router:function(t){const{root:n,routes:e={},head:r={},methods:o={},cache:i=[]}=t,s=l(n),c=h(r),a=d(e,s,c,o,i);f(a.render,s,o),a.render();let m=p();window.onpopstate=(()=>{u(o,s,m),m=p(),a.render()})}}}();